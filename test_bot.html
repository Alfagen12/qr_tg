<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .btn {
            background: #2481cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
            font-size: 16px;
        }
        .btn:hover {
            background: #1c6ab8;
        }
        .info {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ü§ñ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram –±–æ—Ç–∞</h1>
    
    <div class="info">
        <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong><br>
        1. –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Telegram Web App<br>
        2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è<br>
        3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç –≤–∞—à –±–æ—Ç
    </div>

    <button class="btn" onclick="sendTestText()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç</button>
    <button class="btn" onclick="sendTestJSON()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å JSON –¥–∞–Ω–Ω—ã–µ</button>
    <button class="btn" onclick="sendQRExample()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä QR-–∫–æ–¥–∞</button>
    <button class="btn" onclick="testMainButton()">–¢–µ—Å—Ç MainButton</button>
    <button class="btn" onclick="showTelegramInfo()">–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é Telegram</button>

    <div id="log" class="log">–õ–æ–≥–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...\n</div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        function sendTestText() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                const testText = '–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç QR Scanner';
                
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞: ' + testText);
                tg.sendData(testText);
                log('‚úÖ –¢–µ–∫—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ sendData()');
            } else {
                log('‚ùå Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        }

        function sendTestJSON() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                const testData = {
                    action: 'test',
                    message: '–¢–µ—Å—Ç–æ–≤—ã–µ JSON –¥–∞–Ω–Ω—ã–µ',
                    timestamp: Date.now(),
                    type: 'test'
                };
                
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ JSON: ' + JSON.stringify(testData));
                tg.sendData(JSON.stringify(testData));
                log('‚úÖ JSON –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ sendData()');
            } else {
                log('‚ùå Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        }

        function sendQRExample() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                const qrText = 'http://www.youtube.com/watch?v=dQw4w9WgXcQ&ob=av2n';
                
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–º–µ—Ä–∞ QR-–∫–æ–¥–∞: ' + qrText);
                tg.sendData(qrText);
                
                // –¢–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∏–º –∫–∞–∫ JSON
                setTimeout(() => {
                    const qrData = {
                        action: 'qr_scanned',
                        text: qrText,
                        format: 'qr_code',
                        timestamp: Date.now()
                    };
                    tg.sendData(JSON.stringify(qrData));
                    log('‚úÖ QR –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–∞–∫ JSON');
                }, 100);
                
            } else {
                log('‚ùå Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        }

        function testMainButton() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                
                tg.MainButton.setText('üß™ –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞');
                tg.MainButton.show();
                
                tg.MainButton.offClick();
                tg.MainButton.onClick(() => {
                    log('üéØ MainButton –Ω–∞–∂–∞—Ç–∞!');
                    const data = '–î–∞–Ω–Ω—ã–µ –æ—Ç MainButton: ' + new Date().toISOString();
                    tg.sendData(data);
                    log('üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ: ' + data);
                    
                    tg.MainButton.hide();
                });
                
                log('üîò MainButton –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –ø–æ–∫–∞–∑–∞–Ω–∞');
            } else {
                log('‚ùå Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        }

        function showTelegramInfo() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                log('üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Telegram WebApp:');
                log('Version: ' + tg.version);
                log('Platform: ' + tg.platform);
                log('Is Expanded: ' + tg.isExpanded);
                log('Viewport Height: ' + tg.viewportHeight);
                log('Init Data: ' + (tg.initData || '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'));
                log('Theme Params: ' + JSON.stringify(tg.themeParams));
            } else {
                log('‚ùå Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                tg.ready();
                tg.expand();
                log('üöÄ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                log('‚ö†Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤–Ω–µ Telegram');
            }
        });
    </script>
</body>
</html>
